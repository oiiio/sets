1. Run augustCalls.vcf through truthset.pl to aquire truthset without depth filter

$ perl truthset.pl > truthset.vcf

2. Run depthFilter.pl on truthset to filter to depth, quality  and aquire median stats

$ perl depthFilter.pl truthset.vcf > truthset.dp10.vcf

3. Resolve duplicate coordinate reporting

$ grep -Ev "^#" truthset.dp10.GQ40.vcf | cut -f2 | uniq -d > dupPosTruthSet
$ perl resolveDuplicateLinesInTruthSet.pl truthset.dp10.GQ40.vcf > truthset.dp10.GQ40.dedup.vcf

4. Get stats on truthset using the TS info tag.

EQUAL_GQ = the GT and GQ were equal, so the replicate A info was used
EQUAL_GQ_zyg = the GQ were equal, but zygosities were different so the replicate A info was used (occured a small 159 times)
HIGHER_GQ_A = the GT were equal, so the info from A was used due to its higher EQ
HIGHER_GQ_B = the GT were equal, so the info from B was used due to its higher EQ
VALIDvsDOT_A = A had a valid GT versus no genotype in B
VALIDvsDOT_B = B had a valid GT versus no genotype in A
HIGHER_GQ_zyg_A = GT had different zygosity, but A was chosen to emit due to higher GQ
HIGHER_GQ_zyg_B = GT had different zygosity, but B was chosen to emit due to higher GQ

$ bash stats.sh

5. Create a matching list of VCF lines from the experiment calls:

$ bash lineMatcher.sh




NOTES:

There are duplicate positions in the VCF due to reporting multiple alleles over multiple samples. This created an issue where the same position would give different genotypes for the same sample (see chr22:20780097 for the control replicate genotypes). I chose which genotype to use as part of the truthset through the higher GQ, and if equal simply took the first line.
"dupPositions" is a list of these coordinates from the calls after intersecting with truthset.dp10.GQ40


Found line in calls VCF with no genotype data aside from reference call in replicate, may be others of these but in very low numbers:
16	57690148	.	C	T	1375.93	HaplotypeScore Fail	AC=2;AF=0.013;AN=160;BaseQRankSum=-10.945;DP=2871;Dels=0.00;EFF=DOWNSTREAM(MODIFIER||2102||255|GPR56|protein_coding|CODING|ENST00000561988||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||2192|||GPR56|retained_intron|CODING|ENST00000565505||1),DOWNSTREAM(MODIFIER||2205|||GPR56|processed_transcript|CODING|ENST00000564912||1),DOWNSTREAM(MODIFIER||2924||198|GPR56|protein_coding|CODING|ENST00000569101||1),DOWNSTREAM(MODIFIER||2929|||GPR56|nonsense_mediated_decay|CODING|ENST00000568645||1),DOWNSTREAM(MODIFIER||2933|||GPR56|nonsense_mediated_decay|CODING|ENST00000563007||1),DOWNSTREAM(MODIFIER||2942||197|GPR56|protein_coding|CODING|ENST00000566271||1),DOWNSTREAM(MODIFIER||2988||124|GPR56|protein_coding|CODING|ENST00000568531||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||3019||166|GPR56|protein_coding|CODING|ENST00000561696||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||3019||166|GPR56|protein_coding|CODING|ENST00000569494||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4088|||GPR56|processed_transcript|CODING|ENST00000568700||1),DOWNSTREAM(MODIFIER||4612||167|GPR56|protein_coding|CODING|ENST00000561782||1),DOWNSTREAM(MODIFIER||4614||161|GPR56|protein_coding|CODING|ENST00000561833||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4614||67|GPR56|protein_coding|CODING|ENST00000564103||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4622||158|GPR56|protein_coding|CODING|ENST00000561969||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4623||163|GPR56|protein_coding|CODING|ENST00000563862||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4631|||GPR56|processed_transcript|CODING|ENST00000566888||1),DOWNSTREAM(MODIFIER||4632|||GPR56|processed_transcript|CODING|ENST00000562608||1),DOWNSTREAM(MODIFIER||4639||153|GPR56|protein_coding|CODING|ENST00000566169||1),DOWNSTREAM(MODIFIER||4642||152|GPR56|protein_coding|CODING|ENST00000566187||1),DOWNSTREAM(MODIFIER||4650|||GPR56|processed_transcript|CODING|ENST00000561872||1),DOWNSTREAM(MODIFIER||4660||94|GPR56|protein_coding|CODING|ENST00000568979||1),DOWNSTREAM(MODIFIER||4677||145|GPR56|protein_coding|CODING|ENST00000562003||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4679||139|GPR56|protein_coding|CODING|ENST00000565314||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4682||143|GPR56|protein_coding|CODING|ENST00000568234||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4707||130|GPR56|protein_coding|CODING|ENST00000568157||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4708||130|GPR56|protein_coding|CODING|ENST00000564722||1),DOWNSTREAM(MODIFIER||4734||121|GPR56|protein_coding|CODING|ENST00000569158||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4739||124|GPR56|protein_coding|CODING|ENST00000563548||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4744||118|GPR56|protein_coding|CODING|ENST00000565013||1),DOWNSTREAM(MODIFIER||4745||117|GPR56|protein_coding|CODING|ENST00000569531||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4752||115|GPR56|protein_coding|CODING|ENST00000566164||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4753||115|GPR56|protein_coding|CODING|ENST00000567154||1),DOWNSTREAM(MODIFIER||4762||112|GPR56|protein_coding|CODING|ENST00000563445||1),DOWNSTREAM(MODIFIER||4762||117|GPR56|protein_coding|CODING|ENST00000562467||1),DOWNSTREAM(MODIFIER||4762||117|GPR56|protein_coding|CODING|ENST00000567915||1),DOWNSTREAM(MODIFIER||4767||96|GPR56|protein_coding|CODING|ENST00000566508||1),DOWNSTREAM(MODIFIER||4768||110|GPR56|protein_coding|CODING|ENST00000563414||1),DOWNSTREAM(MODIFIER||4769||109|GPR56|protein_coding|CODING|ENST00000569372||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4769|||GPR56|processed_transcript|CODING|ENST00000562101||1),DOWNSTREAM(MODIFIER||4772||113|GPR56|protein_coding|CODING|ENST00000564338||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4779||106|GPR56|protein_coding|CODING|ENST00000567702||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4779|||GPR56|processed_transcript|CODING|ENST00000569992||1),DOWNSTREAM(MODIFIER||4787||117|GPR56|protein_coding|CODING|ENST00000569154||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4790|||GPR56|processed_transcript|CODING|ENST00000569132||1),DOWNSTREAM(MODIFIER||4801||99|GPR56|protein_coding|CODING|ENST00000564360||1),DOWNSTREAM(MODIFIER||4805|||GPR56|processed_transcript|CODING|ENST00000562673||1),DOWNSTREAM(MODIFIER||4806||102|GPR56|protein_coding|CODING|ENST00000566778||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4818||93|GPR56|protein_coding|CODING|ENST00000568618||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4819||93|GPR56|protein_coding|CODING|ENST00000565976||1),DOWNSTREAM(MODIFIER||4821||97|GPR56|protein_coding|CODING|ENST00000567397||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4844||89|GPR56|protein_coding|CODING|ENST00000567553||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4848||83|GPR56|protein_coding|CODING|ENST00000566123||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4848||83|GPR56|protein_coding|CODING|ENST00000568074||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4861||80|GPR56|protein_coding|CODING|ENST00000568791||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4869||76|GPR56|protein_coding|CODING|ENST00000562682||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4869||77|GPR56|protein_coding|CODING|ENST00000563374||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4872||89|GPR56|protein_coding|CODING|ENST00000565770||1),DOWNSTREAM(MODIFIER||4889||69|GPR56|protein_coding|CODING|ENST00000570044||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4932||55|GPR56|protein_coding|CODING|ENST00000565338||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4937||53|GPR56|protein_coding|CODING|ENST00000564729||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4952||48|GPR56|protein_coding|CODING|ENST00000565587||1|WARNING_TRANSCRIPT_INCOMPLETE),DOWNSTREAM(MODIFIER||4974||41|GPR56|protein_coding|CODING|ENST00000562414||1|WARNING_TRANSCRIPT_INCOMPLETE),INTRON(MODIFIER||||185|GPR56|protein_coding|CODING|ENST00000565391|4|1|WARNING_TRANSCRIPT_INCOMPLETE),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T168I|512|GPR56|protein_coding|CODING|ENST00000544297|8|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T173I|523|GPR56|protein_coding|CODING|ENST00000379694|7|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T343I|687|GPR56|protein_coding|CODING|ENST00000388813|9|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T343I|687|GPR56|protein_coding|CODING|ENST00000538815|9|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T343I|687|GPR56|protein_coding|CODING|ENST00000540164|9|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T343I|687|GPR56|protein_coding|CODING|ENST00000562558|9|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T343I|687|GPR56|protein_coding|CODING|ENST00000562631|8|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T343I|687|GPR56|protein_coding|CODING|ENST00000568908|9|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T343I|693|GPR56|protein_coding|CODING|ENST00000379696|8|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T343I|693|GPR56|protein_coding|CODING|ENST00000388812|8|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T343I|693|GPR56|protein_coding|CODING|ENST00000456916|8|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T343I|693|GPR56|protein_coding|CODING|ENST00000567835|9|1),NON_SYNONYMOUS_CODING(MODERATE|MISSENSE|aCt/aTt|T343I|693|GPR56|protein_coding|CODING|ENST00000568909|8|1),UTR_3_PRIME(MODIFIER||4764|||GPR56|nonsense_mediated_decay|CODING|ENST00000564907|8|1),UTR_3_PRIME(MODIFIER||4764|||GPR56|nonsense_mediated_decay|CODING|ENST00000565539|8|1);FS=0.000;HaplotypeScore=14.2555;InbreedingCoeff=0.5024;MLEAC=2;MLEAF=0.013;MQ=59.82;MQ0=1;MQRankSum=-0.739;QD=17.87;ReadPosRankSum=0.203;SOR=0.689;VQSLOD=5.60;culprit=MQ	GT:AD:DP:GQ:PL	0/0:12,0:12:30:0,30,360	0/0:10,0:10:18:0,18,240	.	0/0:38,0:39:87:0,87,1077	0/0:2,0:2:3:0,3,39	0/0:19,0:19:36:0,36,442	0/0:3,0:3:9:0,9,90	.	.	.	0/0:5,0:5:9:0,9,123	0/0:8,0:8:24:0,24,260	.	.	0/0:1,0:1:3:0,3,26	.	0/0
